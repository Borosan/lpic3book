# 333.2 Mandatory Access Control

**Weight:** 5

**Description:** Candidates should be familiar with mandatory access control (MAC) systems for Linux. Specifically, candidates should have a thorough knowledge of SELinux. Also, candidates should be aware of other mandatory access control systems for Linux. This includes major features of these systems but not configuration and use.



**Key Knowledge Areas:**

* Understand the concepts of type enforcement, role based access control, mandatory access control and discretionary access control
* Configure, manage and use SELinux
* Awareness of AppArmor and Smack

**Partial list of the used files, terms and utilities:**

* getenforce
* setenforce
* selinuxenabled
* getsebool
* setsebool
* togglesebool
* fixfiles
* restorecon
* setfiles
* newrole
* setcon
* runcon
* chcon
* semanage
* sestatus
* seinfo
* apol
* seaudit
* audit2why
* audit2allow
* /etc/selinux/\*

## Understanding Mandatory Access Control

### **DAC vs. MAC**

The security model used by most mainstream operating systems is based on Discretionary Access Control (DAC), which enforces security by ownership. If a user owns a file, he is allowed to set the read, write, and execute permissions for that file. In this model, users control the data at their discretion. The owner of the system does not have total control over the system; the users do.

However, the biggest concern with the Linux model is the danger presented by the root account. This super-user has the power to control all files and processes. If the root account, or a process that runs with its privileges, is compromised, an attacker can take control of the system and its data.

A more secure approach would limit or even eliminate the need for a root account, and shift the power from the user accounts to the owner of the system. This is MAC’s approach.

MAC makes the enforcement of security policies mandatory instead of discretionary, as you might imagine from the name Mandatory Access Control. Security policies can be set by the system owner and implemented by a system or security administrator. Once these policies are in place, users cannot override them, even if they have root privileges. With MAC, file and process protection is independent of owners.

{% hint style="info" %}
**The concept**

• Mandatory Access Control (MAC) differs from Discretionary Access Control in that access is based on context and not by ownership.&#x20;

• MAC uses roles and type enforcement (TE) to only allow access to users who are authorized to use resources of a specific type.&#x20;

• MAC is generally implemented by means of a kernel module and through use of extended attributes.
{% endhint %}

famous MAC Systems :

• SELinux&#x20;

• AppArmor&#x20;

• Smack

## SELinux

### Overview <a href="#overview" id="overview"></a>

Security-Enhanced Linux (SELinux) is a security architecture for Linux® systems that allows administrators to have more control over who can access the system. It was originally developed by the United States National Security Agency (NSA) as a series of patches to the Linux kernel using Linux Security Modules (LSM). &#x20;

SELinux was released to the open source community in 2000, and was integrated into the upstream Linux kernel in 2003.

### How does SELinux work? <a href="#how-does-it-work" id="how-does-it-work"></a>

SELinux defines access controls for the applications, processes, and files on a system. It uses security policies, which are a set of rules that tell SELinux what can or can’t be accessed, to enforce the access allowed by a policy.&#x20;

When an application or process, known as a subject, makes a request to access an object, like a file, SELinux checks with an access vector cache (AVC), where permissions are cached for subjects and objects.

If SELinux is unable to make a decision about access based on the cached permissions, it sends the request to the security server. The security server checks for the security context of the app or process and the file. Security context is applied from the SELinux policy database. Permission is then granted or denied.&#x20;

If permission is denied, an "avc: denied" message will be available in /var/log.messages.

### How to configure SELinux&#x20;

There are a number of ways that you can configure SELinux to protect your system. The most common are targeted policy or multi-level security (MLS).

Targeted policy is the default option and covers a range of processes, tasks, and services. MLS can be very complicated and is typically only used by government organizations.&#x20;

You can tell what your system is supposed to be running at by looking at the **/etc/sysconfig/selinux** file. The file will have a section that shows you whether SELinux is in permissive mode, enforcing mode, or disabled, and which policy is supposed to be loaded.

```
[root@rocky8 ~]# cat /etc/sysconfig/selinux

# This file controls the state of SELinux on the system.
# SELINUX= can take one of these three values:
#     enforcing - SELinux security policy is enforced.
#     permissive - SELinux prints warnings instead of enforcing.
#     disabled - No SELinux policy is loaded.
SELINUX=enforcing
# SELINUXTYPE= can take one of these three values:
#     targeted - Targeted processes are protected,
#     minimum - Modification of targeted policy. Only selected processes are protected.
#     mls - Multi Level Security protection.
SELINUXTYPE=targeted
```

> When ever you make a change you do need to reboot the system

{% hint style="info" %}
#### Enabling SELinux

If SELinux has been disabled in your environment, you can enable SElinux by editing /etc/selinux/config and setting SELINUX=permissive. Since SELinux was not currently enabled, you don’t want to set it to enforcing right away because the system will likely have things mislabeled that can keep the system from booting. &#x20;

You can force the system to automatically [relabel the filesystem](https://access.redhat.com/solutions/24845) by creating an empty file named .autorelabel in the root directory and then rebooting. If the system has too many errors, you should reboot while in permissive mode in order for the boot to succeed. After everything has been relabeled, set SELinux to enforcing with /etc/selinux/config and reboot, or run setenforce 1.&#x20;

If a sysadmin is less familiar with the command line, there are graphic tools available that can be used to manage SELinux.&#x20;

SELinux provides an additional layer of security for your system that is built into Linux distributions. It should remain on so that it can protect your system if it is ever compromised.
{% endhint %}

#### **Checking SELinux Mode of Operation**

SELinux is enabled by default and works in the “Enforcing” mode, which is its default mode. You can determine this by   opening the SELinux configuration file **or by** running the “sestatus” command.

```
[root@rocky8 ~]# sestatus
SELinux status:                 enabled
SELinuxfs mount:                /sys/fs/selinux
SELinux root directory:         /etc/selinux
Loaded policy name:             targeted
Current mode:                   enforcing
Mode from config file:          enforcing
Policy MLS status:              enabled
Policy deny_unknown status:     allowed
Memory protection checking:     actual (secure)
Max kernel policy version:      33
```

This can also be verified by running

#### SELinux labeling and type enforcement&#x20;

Type enforcement and labeling are the most important concepts for SELinux.

SELinux works as a labeling system, which means that all of the files, processes, and ports in a system have an SELinux label associated with them. Labels are a logical way of grouping things together. The kernel manages the labels during boot.

Labels are in the format user:role:type:level (level is optional). User, role, and level are used in more advanced implementations of SELinux, like with MLS. Label type is the most important for targeted policy.&#x20;

SELinux uses type enforcement to enforce a policy that is defined on the system. Type enforcement is the part of an SELinux policy that defines whether a process running with a certain type can access a file labeled with a certain type.





MAC Alternatives



.

.

.

resources:

[https://www.linux.com/news/securing-linux-mandatory-access-controls/](https://www.linux.com/news/securing-linux-mandatory-access-controls/)

[https://www.redhat.com/en/topics/linux/what-is-selinux](https://www.redhat.com/en/topics/linux/what-is-selinux)

.
