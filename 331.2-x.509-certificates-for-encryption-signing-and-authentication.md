# 331.2 X.509 Certificates for Encryption, Signing and Authentication

**Weight:** 4

**Description:** Candidates should be able to use X.509 certificates for both server and client authentication. This includes implementing user and server authentication for Apache HTTPD. The version of Apache HTTPD covered is 2.4 or higher.



**Key Knowledge Areas:**

* Understand SSL, TLS, including protocol versions and ciphers
* Configure Apache HTTPD with mod\_ssl to provide HTTPS service, including SNI and HSTS
* Configure Apache HTTPD with mod\_ssl to serve certificate chains and adjust the cipher configuration (no cipher-specific knowledge)
* Configure Apache HTTPD with mod\_ssl to authenticate users using certificates
* Configure Apache HTTPD with mod\_ssl to provide OCSP stapling
* Use OpenSSL for SSL/TLS client and server tests

**Partial list of the used files, terms and utilities:**

* httpd.conf
* mod\_ssl
* openssl (including relevant subcommands)

## SSL, TLS and common Transport Security Threats

### SSL and TLS&#x20;

SSL and TLS were developed primarily to protect Web transactions, but they can be used to protect any type network traffic that utilizes TCP at the transport layer. Both SSL and TLS are located above TCP in the protocol stack. Applications that interface with TCP when security is not required interface with SSL or TLS when security is required.

| SSL                                                               | TLS                                                                                         |   |
| ----------------------------------------------------------------- | ------------------------------------------------------------------------------------------- | - |
| stands for Secure Sockets Layer                                   | stands for Transport Layer Security                                                         |   |
| originally the protocol used to secure web traffic                | The TLS protocol is the successor to SSL beginning with TLS 1.0 which replaced SSLv3        |   |
| The latest version of SSL is SSLV3, which **has been deprecated** | The current standard is TLS 1.2; however, TLS 1.3 has been purposed as an Internet Standard |   |
| **Due to the deprecated nature of SSL, it should not be used.**   |                                                                                             |   |

### Transport Layer Seurity

SSL and TLS both are solutions to answer security issues exists in a public network communication. The protocols meet the following needs:&#x20;

• Securely encrypt exchanged data&#x20;

• Authenticate at least one party&#x20;

• Ensure data integrity&#x20;

• Prevent replay attacks&#x20;

_Transport layer security achieves this through the use of PKI as well as general encryption practice._

{% hint style="info" %}
**How does TLS work?**

TLS uses a combination of symmetric and asymmetric cryptography, as this provides a good compromise between performance and security when transmitting data securely.

****

**THE TLS/SSL HANDSHAKE PROCESS**

1. Each TLS certificate consists of a key pair made of a public key and private key.\
   These keys are important because they interact behind the scenes during website transactions.
2. Every time you visit a website, the client server and web browser communicate to ensure there is a secure TLS/SSL encrypted connection.
3. When a web browser (or client) directs to a secured website, the website server shares its TLS/SSL certificate and its public key with the client to establish a secure connection and a unique session key.
4. The browser confirms that it recognizes and trusts the issuer, or Certificate Authority, of the SSL certificate—in this case DigiCert. The browser also checks to ensure the TLS/SSL certificate is unexpired, unrevoked, and that it can be trusted.
5. The browser sends back a symmetric session key and the server decrypts the symmetric session key using its private key. The server then sends back an acknowledgement encrypted with the session key to start the encrypted session.
6. Server and browser now encrypt all transmitted data with the session key. They begin a secure session that protects message privacy, message integrity, and server security.


{% endhint %}

### Man-in-the-Middle Attack

A man-in-the-middle attack is a type of eavesdropping attack, where attackers interrupt an existing conversation or data transfer. After inserting themselves in the "middle" of the transfer, the attackers pretend to be both legitimate participants. This enables an attacker to intercept information and data from either party while also sending malicious links or other information to both legitimate participants in a way that might not be detected until it is too late.

You can think of this type of attack as similar to the game of telephone where one person's words are carried along from participant to participant until it has changed by the time it reaches the final person. In a man-in-the-middle attack, the middle participant manipulates the conversation unknown to either of the two legitimate participants, acting to retrieve confidential information and otherwise cause damage.

_Common abbreviations for a man-in-the-middle attack including MITM, MitM, MiM, and MIM._

There are different types of Man in the Middle Attacks, one of them is SSL Hijackting:

<figure><img src=".gitbook/assets/mim-sslhijackting.jpg" alt=""><figcaption></figcaption></figure>

> _This is what it is critically important to use TLS 1.3 or newer as soon as feasible. It is also important to encrypt all traffic._&#x20;

**POODLE attack vulnerability**

The POODLE attack (which stands for "Padding Oracle On Downgraded Legacy Encryption", CVE-2014-3566) is a [man-in-the-middle](https://en.wikipedia.org/wiki/Man-in-the-middle\_attack) (MITM) exploit which allows a hacker to decrypt select content within the SSL session.

Variations of the POODLE vulnerability affects TLS because an active MITM attacker can force a browser to downgrade the session down to SSLv3, which can then be exploited.

\
**BEAST attack vulnerability**

The BEAST attack, reported as CVE-2011-3389, exploits a weakness in SSL/TLS cipher-block chaining (CBC), allowing a [man-in-the-middle](https://en.wikipedia.org/wiki/Man-in-the-middle\_attack) attacker to recover certain session information, such as cookie data, from what should be a secure connection.

> With each TLS update, vulnerabilities such as POODLE and BEAST are patched, and weak ciphers are de-supported.





__







Working with Apache's mod\_ssl

Troubleshooting using openssl



.

.

.

resources:

[https://www.internetsociety.org/deploy360/tls/basics/?gclid=CjwKCAjw9suYBhBIEiwA7iMhNE6kSxuyEI2Q-l6TWljb4fajZoD22KG86iRnknekuJHIUVuz1boQ-RoCCk8QAvD\_BwE](https://www.internetsociety.org/deploy360/tls/basics/?gclid=CjwKCAjw9suYBhBIEiwA7iMhNE6kSxuyEI2Q-l6TWljb4fajZoD22KG86iRnknekuJHIUVuz1boQ-RoCCk8QAvD\_BwE)

[https://www.digicert.com/how-tls-ssl-certificates-work](https://www.digicert.com/how-tls-ssl-certificates-work)

[https://www.veracode.com/security/man-middle-attack](https://www.veracode.com/security/man-middle-attack)

..
