# 334.2 Network Intrusion Detection

**Weight:** 4

**Description:** Candidates should be familiar with the use and configuration of network security scanning, network monitoring and network intrusion detection software. This includes updating and maintaining the security scanners.



**Key Knowledge Areas:**

* Implement bandwidth usage monitoring
* Configure and use Snort, including rule management
* Configure and use OpenVAS, including NASL

**Partial list of the used files, terms and utilities:**

* ntop
* snort
* snort-stat
* pulledpork.pl
* /etc/snort/\*
* openvas-adduser
* openvas-rmuser
* openvas-nvt-sync
* openvassd
* openvas-mkcert
* openvas-feed-update
* /etc/openvas/\*



## Network Monitoring

### ntop

ntop is the best tool to see network usage in a way similar to what top command does for processes i.e. it is network traffic monitoring software. You can see network status, protocol wise distribution of traffic for UDP, TCP, DNS, HTTP and other protocols.

ntop is a hybrid layer 2 / layer 3 network monitor, that is by default it uses the layer 2 Media Access Control (MAC) addresses AND the layer 3 tcp/ip addresses. ntop is capable of associating the two, so that ip and non-ip traffic (e.g. arp, rarp) are combined for a complete picture of network activity.

<figure><img src=".gitbook/assets/ntop.jpg" alt=""><figcaption></figcaption></figure>

ntop is a network probe that shows in interactive mode, it displays the network status on the userâ€™s terminal. In Web mode, it acts as a Web server, creating a HTML dump of the network status.

{% hint style="danger" %}
ntop is currently replaced by **ntopng**
{% endhint %}

examples:

| ntop Command                         | Description                                                                |   |
| ------------------------------------ | -------------------------------------------------------------------------- | - |
| /usr/sbin/ntop -A                    | Set ntop admin user password                                               |   |
| ntop -P /etc/ntop -w4242 -d          | run ntop as daemon with /etc/ntop config files serving at port number 4242 |   |
| ntop --set-admin-password=newassword | setting new admin password                                                 |   |



{% hint style="info" %}
**ntopng**

ntopng is the next generation version of the original ntop, a network traffic probe that monitors network usage. ntopng is based on libpcap and it has been written in a portable way in order to virtually run on every Unix platform, MacOSX and on Windows as well.
{% endhint %}

{% hint style="info" %}
**cacti**

Cacti is **an open-source network monitoring tool** that uses the Simple Network Management Protocol (SNMP) to monitor network traffic and bandwidth utilization of network devices such as routers and switches. It is more General purpose than ntop.
{% endhint %}



Working with Snort



OpenVas and NASL



.

.

.

resources:

[https://www.cyberciti.biz/faq/debian-ubuntu-install-ntop-network-traffic-monitoring-software/](https://www.cyberciti.biz/faq/debian-ubuntu-install-ntop-network-traffic-monitoring-software/)

.

